<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Navigation</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>
<div class="container">
    <header class="header">
        <h1>AUGMENTED <span>REALITY</span></h1>
        <p>Jelajahi dunia digital dan pengalaman interaktif</p>
    </header>

    <div class="menu-wrapper">
        <button class="btn-main" onclick="navigateTo('starts.html')">
            <span class="icon-main">ğŸš€</span>
            <div class="btn-text-main">
                <span class="title">MULAI SEKARANG</span>
                <span class="subtitle">Enter AR Camera Mode</span>
            </div>
        </button>

        <div class="btn-grid">
            <button class="btn-sub" onclick="navigateTo('guides.html')">
                <span class="icon-small">ğŸ“–</span>
                <div class="btn-content">
                    <span class="txt-id">Panduan</span>
                    <span class="txt-en">Guide</span>
                </div>
            </button>

            <button class="btn-sub" onclick="navigateTo('ar_markers.html')">
                <span class="icon-small">ğŸ¯</span>
                <div class="btn-content">
                    <span class="txt-id">Marker</span>
                    <span class="txt-en">AR Marker</span>
                </div>
            </button>

            <button class="btn-sub" onclick="navigateTo('quiz.html')">
                <span class="icon-small">ğŸ’¡</span>
                <div class="btn-content">
                    <span class="txt-id">Kuis</span>
                    <span class="txt-en">Quiz</span>
                </div>
            </button>

            <button class="btn-sub" onclick="navigateTo('learning.html')">
                <span class="icon-small">ğŸ“‹</span>
                <div class="btn-content">
                    <span class="txt-id">Materi</span>
                    <span class="txt-en">Material</span>
                </div>
            </button>

            <button class="btn-sub" onclick="navigateTo('about.html')">
                <span class="icon-small">â„¹ï¸</span>
                <div class="btn-content">
                    <span class="txt-id">Tentang</span>
                    <span class="txt-en">About Us</span>
                </div>
            </button>

            <button class="btn-sub" onclick="navigateTo('feedback.html')">
                <span class="icon-small">â­</span>
                <div class="btn-content">
                    <span class="txt-id">Ulasan</span>
                    <span class="txt-en">Feedback</span>
                </div>
            </button>
        </div>
    </div>
    <div class="rating-stats" id="ratingStats" style="display: none;"> <div class="rating-score">
        <span id="avgRating" class="score-value">0.0</span>
        <div class="stars-static">
            â˜…â˜…â˜…â˜…â˜…
            <div id="starFill" class="stars-active" style="width: 0%;">â˜…â˜…â˜…â˜…â˜…</div>
        </div>
    </div>
    <p id="reviewCount" class="total-reviews">Memuat ulasan...</p>
</div>
</div>

<script>

    // Pastikan library Supabase sudah ada di header (seperti di file feedback kamu)
const SUPABASE_URL = 'https://bmswsgtgxmijjomkltzx.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJtc3dzZ3RneG1pampvbWtsdHp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAyOTc5MDIsImV4cCI6MjA4NTg3MzkwMn0.tudVaH1BpfQA2h6EhWv2ekmhAPMTgDhiEKRbvCOM074';
const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

async function loadRatingStats() {
    try {
        // 1. Ambil semua data rating dari kolom 'rating'
        const { data, error, count } = await _supabase
            .from('feedback')
            .select('rating', { count: 'exact' });

        if (error) throw error;

        if (data && data.length > 0) {
            // 2. Hitung total rating
            const totalScore = data.reduce((acc, curr) => acc + curr.rating, 0);
            
            // 3. Hitung rata-rata (1 angka di belakang koma)
            const average = (totalScore / data.length).toFixed(1);
            
            // 4. Hitung persentase untuk lebar bintang (misal: 4.5 / 5 * 100 = 90%)
            const starPercentage = (average / 5) * 100;

            // 5. Update tampilan
            document.getElementById('avgRating').innerText = average;
            document.getElementById('reviewCount').innerText = `Berdasarkan ${data.length} Ulasan`;
            document.getElementById('starFill').style.width = `${starPercentage}%`;
            document.getElementById('ratingStats').style.display = 'block';
        }
    } catch (err) {
        console.error('Gagal memuat statistik:', err.message);
    }
}

// Jalankan fungsi saat halaman dibuka
window.onload = loadRatingStats;

        function navigateTo(url) {
        // Menambahkan sedikit efek delay agar user bisa melihat animasi tombol saat ditekan
        setTimeout(() => {
            window.location.href = url;
        }, 150); 
    }
</script>

</body>
</html>

